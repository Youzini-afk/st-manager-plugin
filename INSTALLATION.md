# ST Manager Plugin å®‰è£…å’Œä½¿ç”¨æŒ‡å—

## ğŸ“¦ å®‰è£…æ–¹æ³•

### æ–¹æ³• 1ï¼šé€šè¿‡ GitHubï¼ˆæ¨èï¼‰

1. **ä¸‹è½½æ’ä»¶**
   ```bash
   cd /path/to/SillyTavern/public/scripts/extensions/third-party
   git clone https://github.com/Youzini-afk/st-manager-plugin.git st-manager
   ```

2. **è¿›å…¥æ’ä»¶ç›®å½•å¹¶æ„å»º**
   ```bash
   cd st-manager
   npm install
   npm run build
   ```

3. **é‡å¯ SillyTavern**
   - åˆ·æ–°æµè§ˆå™¨é¡µé¢ï¼Œæ’ä»¶ä¼šè‡ªåŠ¨åŠ è½½

### æ–¹æ³• 2ï¼šæ‰‹åŠ¨å®‰è£…

1. ä» [GitHub Releases](https://github.com/Youzini-afk/st-manager-plugin/releases) ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
2. è§£å‹åˆ° `SillyTavern/public/scripts/extensions/third-party/st-manager/`
3. ç¡®ä¿æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š
   ```
   third-party/
   â””â”€â”€ st-manager/
       â”œâ”€â”€ manifest.json
       â”œâ”€â”€ dist/
       â”‚   â”œâ”€â”€ index.iife.js
       â”‚   â””â”€â”€ style.css
       â””â”€â”€ ...
   ```
4. é‡å¯ SillyTavern

---

## ğŸš€ å¯åŠ¨åç«¯æœåŠ¡

ST Manager éœ€è¦ç‹¬ç«‹è¿è¡Œ Python åç«¯æœåŠ¡æ¥æä¾›èµ„æºç®¡ç†å’Œå¤‡ä»½åŠŸèƒ½ã€‚

### å®‰è£… Python ä¾èµ–

```bash
cd /path/to/ST-Manager
pip install -r requirements.txt
```

### é…ç½®åç«¯

ç¼–è¾‘ `config.json` æ–‡ä»¶ï¼Œè®¾ç½® SillyTavern æ•°æ®ç›®å½•ï¼š

```json
{
  "st_data_path": "/path/to/SillyTavern/data",
  "backup": {
    "enabled": true,
    "path": "data/backups",
    "schedule": "daily",
    "retention_days": 30
  }
}
```

### å¯åŠ¨åç«¯æœåŠ¡

```bash
# æ ‡å‡†æ¨¡å¼ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
python app.py

# æˆ–è°ƒè¯•æ¨¡å¼ï¼ˆå¼€å‘ç¯å¢ƒï¼Œæ”¯æŒçƒ­é‡è½½ï¼‰
python app.py --debug
```

åç«¯é»˜è®¤è¿è¡Œåœ¨ `http://localhost:5000`

---

## ğŸ¯ ä½¿ç”¨è¯´æ˜

### 1. åœ¨é…’é¦†å†…ä½¿ç”¨æ’ä»¶

å®‰è£…æˆåŠŸåï¼Œæœ‰ä¸¤ç§æ–¹å¼è®¿é—® ST Managerï¼š

#### æ–¹å¼ Aï¼šé€šè¿‡æ‰©å±•èœå•ï¼ˆé­”æ³•æ£’ï¼‰

1. ç‚¹å‡»é…’é¦†å³ä¸Šè§’çš„ **é­”æ³•æ£’å›¾æ ‡**ï¼ˆæ‰©å±•èœå•ï¼‰
2. åœ¨å¼¹å‡ºèœå•ä¸­æ‰¾åˆ° **"ST Manager èµ„æºç®¡ç†"**
3. ç‚¹å‡»åä¼šåœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€ Web UI

#### æ–¹å¼ Bï¼šé€šè¿‡æ‰©å±•è®¾ç½®é¢æ¿

1. è¿›å…¥ **è®¾ç½® (Settings)** â†’ **æ‰©å±•è®¾ç½® (Extensions)**
2. æ‰¾åˆ° **"ST Manager èµ„æºç®¡ç†"** æŠ˜å é¢æ¿
3. å±•å¼€é¢æ¿å¯ä»¥æŸ¥çœ‹ï¼š
   - **æ¦‚è§ˆ**: åç«¯è¿æ¥çŠ¶æ€ã€èµ„æºç»Ÿè®¡ã€å¤‡ä»½ä¿¡æ¯
   - **èµ„æºç®¡ç†**: è§’è‰²å¡ã€ä¸–ç•Œä¹¦ã€é¢„è®¾ã€æ­£åˆ™è„šæœ¬ç­‰
   - **å¤‡ä»½ç®¡ç†**: åˆ›å»ºå¤‡ä»½ã€æ¢å¤å¤‡ä»½ã€å®šæ—¶ä»»åŠ¡é…ç½®
   - **è®¾ç½®**: é…ç½®åç«¯åœ°å€ã€åå¥½è®¾ç½®

### 2. é…ç½®åç«¯è¿æ¥

é¦–æ¬¡ä½¿ç”¨éœ€è¦é…ç½®åç«¯åœ°å€ï¼š

1. æ‰“å¼€ **è®¾ç½®** æ ‡ç­¾é¡µ
2. åœ¨ **"åç«¯åœ°å€"** è¾“å…¥æ¡†å¡«å…¥ï¼š`http://localhost:5000`
3. ç‚¹å‡» **"ä¿å­˜å¹¶é‡è¿"** æŒ‰é’®
4. çœ‹åˆ° **"åç«¯è¿æ¥æˆåŠŸ"** æç¤ºå³å¯

> ğŸ’¡ **æç¤º**: å¦‚æœåç«¯è¿è¡Œåœ¨å…¶ä»–ç«¯å£æˆ–è¿œç¨‹æœåŠ¡å™¨ï¼Œä¿®æ”¹åœ°å€å³å¯ï¼Œä¾‹å¦‚ï¼š
> - `http://localhost:8080`
> - `http://192.168.1.100:5000`

### 3. æ‰“å¼€ Web UI

æœ‰å¤šç§æ–¹å¼æ‰“å¼€å®Œæ•´çš„ Web UIï¼š

- **æ¦‚è§ˆé¢æ¿**: ç‚¹å‡» **"æ‰“å¼€ Web UI"** æŒ‰é’®
- **è®¾ç½®é¢æ¿**: ç‚¹å‡» **"æ‰“å¼€ Web UI"** æŒ‰é’®ï¼ˆéœ€å·²è¿æ¥åç«¯ï¼‰
- **æ‰©å±•èœå•**: ç‚¹å‡»é­”æ³•æ£’ â†’ ST Manager èµ„æºç®¡ç†

Web UI æä¾›æ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š
- å¡ç‰‡è¯¦æƒ…ç¼–è¾‘å’Œé¢„è§ˆ
- æ‰¹é‡æ“ä½œå’Œæ ‡ç­¾ç®¡ç†
- é«˜çº§æœç´¢å’Œè¿‡æ»¤
- è‡ªåŠ¨åŒ–ä»»åŠ¡é…ç½®
- ç³»ç»Ÿç›‘æ§å’Œæ—¥å¿—æŸ¥çœ‹

### 4. å¤‡ä»½ä¸æ¢å¤

#### æ‰‹åŠ¨å¤‡ä»½
1. è¿›å…¥ **"å¤‡ä»½ç®¡ç†"** æ ‡ç­¾é¡µ
2. ç‚¹å‡» **"ç«‹å³å¤‡ä»½"** æŒ‰é’®
3. å¯é€‰æ‹©ï¼š
   - **å®Œæ•´å¤‡ä»½**: å¤‡ä»½æ‰€æœ‰èµ„æº
   - **å¢é‡å¤‡ä»½**: ä»…å¤‡ä»½ä¿®æ”¹è¿‡çš„æ–‡ä»¶

#### å®šæ—¶å¤‡ä»½
1. è¿›å…¥ **"å¤‡ä»½ç®¡ç†"** æ ‡ç­¾é¡µ
2. é€‰æ‹©å¤‡ä»½é¢‘ç‡ï¼š
   - **æ¯æ—¥**: æ¯å¤©å‡Œæ™¨ 3 ç‚¹è‡ªåŠ¨å¤‡ä»½
   - **æ¯å‘¨**: æ¯å‘¨æ—¥å‡Œæ™¨ 3 ç‚¹è‡ªåŠ¨å¤‡ä»½
   - **ç¦ç”¨**: å…³é—­è‡ªåŠ¨å¤‡ä»½
3. ç‚¹å‡» **"ä¿å­˜è®¡åˆ’"** æŒ‰é’®

#### æ¢å¤å¤‡ä»½
1. åœ¨å¤‡ä»½åˆ—è¡¨ä¸­æ‰¾åˆ°éœ€è¦æ¢å¤çš„å¤‡ä»½
2. ç‚¹å‡» **"æ¢å¤"** æŒ‰é’®
3. ç¡®è®¤æ“ä½œåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ¢å¤æ–‡ä»¶
4. å»ºè®®åœ¨æ¢å¤å‰å…ˆåˆ›å»ºå½“å‰çŠ¶æ€çš„å¤‡ä»½

---

## âš™ï¸ é…ç½®é€‰é¡¹

### åç«¯é…ç½® (`config.json`)

```json
{
  "st_data_path": "/path/to/SillyTavern/data",
  "backup": {
    "enabled": true,                // å¯ç”¨å¤‡ä»½åŠŸèƒ½
    "path": "data/backups",        // å¤‡ä»½å­˜å‚¨è·¯å¾„ï¼ˆæ”¯æŒå¤–éƒ¨ç›®å½•ï¼‰
    "schedule": "daily",           // å®šæ—¶ä»»åŠ¡ï¼šdaily/weekly/disabled
    "retention_days": 30           // å¤‡ä»½ä¿ç•™å¤©æ•°
  },
  "cors": {
    "enabled": true,                // å¯ç”¨ CORS
    "origins": [                    // å…è®¸çš„æ¥æº
      "http://localhost:8000",      // é…’é¦†é»˜è®¤åœ°å€
      "http://127.0.0.1:8000"
    ]
  },
  "sync": {
    "enabled": false,               // å¯ç”¨èµ„æºåŒæ­¥
    "interval": 300                 // åŒæ­¥é—´éš”ï¼ˆç§’ï¼‰
  }
}
```

### å‰ç«¯é…ç½®ï¼ˆæ’ä»¶å†…ï¼‰

é€šè¿‡æ’ä»¶è®¾ç½®é¢æ¿å¯é…ç½®ï¼š
- **åç«¯åœ°å€**: é»˜è®¤ `http://localhost:5000`
- **è‡ªåŠ¨è¿æ¥**: å¯åŠ¨æ—¶è‡ªåŠ¨å°è¯•è¿æ¥åç«¯
- **é€šçŸ¥è®¾ç½®**: å¼€å¯/å…³é—­æ“ä½œæç¤º

é…ç½®ä¼šè‡ªåŠ¨ä¿å­˜åˆ°æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–è¾‘æ–‡ä»¶ã€‚

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ 1: æ’ä»¶æœªåŠ è½½

**ç—‡çŠ¶**: åœ¨æ‰©å±•è®¾ç½®ä¸­æ‰¾ä¸åˆ° ST Manager

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥æ’ä»¶ç›®å½•æ˜¯å¦æ­£ç¡®ï¼š`SillyTavern/public/scripts/extensions/third-party/st-manager/`
2. ç¡®è®¤ `manifest.json` å’Œ `dist/index.iife.js` æ–‡ä»¶å­˜åœ¨
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å° (F12) æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
4. å°è¯•æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å¹¶åˆ·æ–°é¡µé¢

### é—®é¢˜ 2: æ— æ³•è¿æ¥åç«¯

**ç—‡çŠ¶**: æ˜¾ç¤º "åç«¯è¿æ¥å¤±è´¥" æˆ– "ç¦»çº¿"

**è§£å†³æ–¹æ³•**:
1. ç¡®è®¤ Python åç«¯å·²å¯åŠ¨ï¼š`python app.py`
2. æ£€æŸ¥åç«¯åœ°å€æ˜¯å¦æ­£ç¡®ï¼šé»˜è®¤åº”ä¸º `http://localhost:5000`
3. æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº†ç«¯å£ 5000
4. æŸ¥çœ‹åç«¯æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
5. å°è¯•åœ¨æµè§ˆå™¨ç›´æ¥è®¿é—® `http://localhost:5000/api/v2/health`

### é—®é¢˜ 3: å¤‡ä»½å¤±è´¥

**ç—‡çŠ¶**: ç‚¹å‡»å¤‡ä»½æŒ‰é’®åæç¤ºé”™è¯¯

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥ `config.json` ä¸­çš„ `st_data_path` æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤å¤‡ä»½ç›®å½•æœ‰å†™å…¥æƒé™
3. æ£€æŸ¥ç£ç›˜ç©ºé—´æ˜¯å¦å……è¶³
4. æŸ¥çœ‹åç«¯æ—¥å¿—äº†è§£è¯¦ç»†é”™è¯¯ä¿¡æ¯

### é—®é¢˜ 4: CORS é”™è¯¯

**ç—‡çŠ¶**: æ§åˆ¶å°æ˜¾ç¤º "Access-Control-Allow-Origin" é”™è¯¯

**è§£å†³æ–¹æ³•**:
1. ç¡®è®¤ `config.json` ä¸­ `cors.enabled` ä¸º `true`
2. æ£€æŸ¥ `cors.origins` æ˜¯å¦åŒ…å«é…’é¦†çš„è®¿é—®åœ°å€
3. é‡å¯åç«¯æœåŠ¡ä½¿é…ç½®ç”Ÿæ•ˆ

---

## ğŸ“š API ä½¿ç”¨

ST Manager æä¾›å…¨å±€ JavaScript APIï¼Œå¯åœ¨é…’é¦†çš„å…¶ä»–æ’ä»¶æˆ–è„šæœ¬ä¸­è°ƒç”¨ï¼š

```javascript
// æ£€æŸ¥æ’ä»¶æ˜¯å¦å·²åŠ è½½
if (window.STManagerPlugin) {
  // è·å–æ’ä»¶ç‰ˆæœ¬
  console.log(window.STManagerPlugin.version);

  // æ£€æŸ¥åç«¯è¿æ¥
  const connected = await window.STManagerPlugin.connect();

  // è§¦å‘å¤‡ä»½
  await window.STManagerPlugin.backup.trigger({
    type: 'full',
    resources: ['characters', 'worldbooks']
  });

  // è·å–å¤‡ä»½åˆ—è¡¨
  const backups = await window.STManagerPlugin.backup.list();

  // æ¢å¤å¤‡ä»½
  await window.STManagerPlugin.backup.restore('backup_20240101_120000');
}
```

è¯¦ç»† API æ–‡æ¡£è¯·å‚è€ƒ [src/types.ts](src/types.ts)

---

## ğŸ› ï¸ å¼€å‘è¯´æ˜

### æœ¬åœ°å¼€å‘

```bash
# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# ç±»å‹æ£€æŸ¥
npm run type-check
```

### é¡¹ç›®ç»“æ„

```
st-manager-plugin/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts              # æ’ä»¶å…¥å£
â”‚   â”œâ”€â”€ App.vue               # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ types.ts              # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ components/           # Vue ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ OverviewPanel.vue
â”‚   â”‚   â”œâ”€â”€ ResourcePanel.vue
â”‚   â”‚   â”œâ”€â”€ BackupPanel.vue
â”‚   â”‚   â””â”€â”€ SettingsPanel.vue
â”‚   â””â”€â”€ services/             # æœåŠ¡å±‚
â”‚       â”œâ”€â”€ backendApi.ts     # åç«¯ API å°è£…
â”‚       â””â”€â”€ stApi.ts          # SillyTavern API å°è£…
â”œâ”€â”€ dist/                     # æ„å»ºè¾“å‡º
â”œâ”€â”€ manifest.json             # æ’ä»¶å…ƒæ•°æ®
â”œâ”€â”€ package.json              # npm é…ç½®
â”œâ”€â”€ tsconfig.json             # TypeScript é…ç½®
â””â”€â”€ vite.config.ts            # Vite æ„å»ºé…ç½®
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-XX)

**æ–°åŠŸèƒ½**:
- âœ¨ åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- ğŸ¯ æ”¯æŒåœ¨é…’é¦†æ‰©å±•èœå•ä¸­æ‰“å¼€ Web UI
- âš™ï¸ å‰ç«¯é…ç½®åç«¯åœ°å€ï¼Œæ— éœ€ç¼–è¾‘ config.json
- ğŸ’¾ å®Œæ•´å¤‡ä»½å’Œå¢é‡å¤‡ä»½æ”¯æŒ
- ğŸ“… å®šæ—¶å¤‡ä»½ä»»åŠ¡ï¼ˆæ¯æ—¥/æ¯å‘¨ï¼‰
- ğŸ”„ èµ„æºç®¡ç†å’ŒåŒæ­¥
- ğŸ“Š ç»Ÿè®¡å’Œç›‘æ§é¢æ¿

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

- GitHub: https://github.com/Youzini-afk/st-manager-plugin
- è®¨è®º: [Issues é¡µé¢](https://github.com/Youzini-afk/st-manager-plugin/issues)

---

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶
